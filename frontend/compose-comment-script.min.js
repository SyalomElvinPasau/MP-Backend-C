document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("image"),t=document.getElementById("preview");e&&e.addEventListener("change",(()=>{const n=e.files[0];n?(t.src=URL.createObjectURL(n),t.style.display="block"):(t.style.display="none",t.src="")}));const n=document.getElementById("clearBtn");n&&n.addEventListener("click",(()=>{document.getElementById("text").value="",e.value="",t.style.display="none",t.src=""}));const d=document.getElementById("commentForm");d&&d.addEventListener("submit",(t=>{const n=document.getElementById("text").value.trim(),d=e.files[0];if(!n&&!d)return t.preventDefault(),void alert("Please enter a comment or upload an image.")}));const l=document.getElementById("text");l&&l.addEventListener("input",(function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"})),document.querySelectorAll(".like-btn").forEach((e=>{e.addEventListener("click",(async e=>{const t=e.target.dataset.postId,n=await fetch(`/like-post?postId=${t}`,{method:"POST"}),d=await n.json();e.target.src=d.liked?"/icon/heart-filled.png":"/icon/heart.png",e.target.nextElementSibling.textContent=d.likes}))}))}));